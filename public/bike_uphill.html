<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—…í ë¶„ì„ê¸°</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="bucheonTriStyle.css">
    <script src="menu_full_handler.js" defer></script>
    <script src="back_exit_handler.js" defer></script>
    <style>
        :root { --primary: #e67e22; --danger: #d63031; --success: #27ae60; --bg: #f8f9fa; }

        /* ë¹„ì£¼ì–¼ & ìƒíƒœì°½ */
        .visual-container { height: 160px; background: #e0f7fa; position: relative; border-radius: 15px; overflow: hidden; margin-bottom: 20px; display: flex; align-items: flex-end; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .road { width: 200%; height: 500px; background: #555; position: absolute; bottom: -450px; transform-origin: center; transition: 0.5s; border-top: 4px dotted #fff; }
        
        .bike { 
            font-size: 60px; 
            position: relative; 
            z-index: 5; 
            bottom: 30px; 
            transition: 0.5s; 
            display: inline-block; 
        } 

        @keyframes pedal-move {
            0%, 100% { transform: rotate(0deg) translateY(0px); }
            25% { transform: rotate(-2deg) translateY(-2px); }
            75% { transform: rotate(2deg) translateY(-2px); }
        }


        .status-board { background: #fff; padding: 20px; border-radius: 12px; text-align: center; margin-bottom: 25px; border: 1px solid #ffe0b2; box-shadow: 0 4px 15px rgba(230, 126, 34, 0.1); }
        .main-res { font-size: 2.5em; font-weight: 800; color: var(--primary); margin: 10px 0; letter-spacing: -1px; }
        #course-tag { font-size: 1.1em; margin-bottom: 5px; }

        /* ì…ë ¥ ê·¸ë¦¬ë“œ */
        .setup-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .group { display: flex; flex-direction: column; background: #fff; padding: 15px; border-radius: 12px; border: 1px solid #eee; box-shadow: 0 2px 5px rgba(0,0,0,0.02); transition: transform 0.2s; }
        .group:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        
        label { font-size: 0.9em; font-weight: 700; margin-bottom: 10px; color: #555; display: flex; justify-content: space-between; align-items: center; }
        label span { color: var(--primary); font-size: 1.2em; font-weight: 800; }
        
        input[type="range"] { width: 100%; cursor: pointer; accent-color: var(--primary); height: 6px; border-radius: 3px; }
        input[type="number"], select, input[type="text"] { padding: 10px; border: 1px solid #ddd; border-radius: 8px; margin-top: 5px; font-size: 1rem; width: 100%; box-sizing: border-box; }
        input[type="number"]:focus, select:focus { outline: none; border-color: var(--primary); }

        /* ì§ì ‘ ì…ë ¥ ì„¹ì…˜ */
        .custom-row { display: flex; gap: 10px; margin-top: 10px; }
        .add-btn { background: #2d3436; color: white; border: none; padding: 0 20px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: background 0.2s; white-space: nowrap; }
        .add-btn:hover { background: #000; }

        /* ê²°ê³¼ í…Œì´ë¸” */
        .table-wrapper { overflow-x: auto; border-radius: 12px; border: 1px solid #eee; box-shadow: 0 2px 8px rgba(0,0,0,0.03); }
        table { width: 100%; border-collapse: collapse; font-size: 0.95em; background: #fff; min-width: 500px; }
        th { background: #f8f9fa; padding: 15px; border-bottom: 2px solid #dee2e6; color: #444; font-weight: 700; }
        td { padding: 12px 15px; text-align: center; border-bottom: 1px solid #f1f1f1; color: #333; }
        tr.active-row { background: #fff3e0 !important; border-left: 4px solid var(--primary); }
        tr.active-row td { font-weight: bold; color: #d35400; }
        tr.clickable { transition: background 0.1s; }
        tr.clickable:hover { background: #f8f9fa; cursor: pointer; }
        
        .rpm-bad { color: var(--danger) !important; font-weight: bold; }
        .rpm-good { color: var(--success) !important; font-weight: bold; }
        .rpm-neutral { color: #7f8c8d !important; }
        .highlight-box { border: 2px solid var(--primary) !important; background: #fff9f5; }
        
        .hint { font-size: 0.85em; color: #888; margin-top: 8px; text-align: right; margin-bottom: 5px; }

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 768px) {
            .setup-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            .group { grid-column: 1 / -1; }
            .half-mobile { grid-column: auto; }
            .visual-container { height: 140px; }
            .bike { font-size: 35px; }
            .main-res { font-size: 2em; }
            .status-board { padding: 15px; }
            
            th, td { padding: 10px 2px; font-size: 0.8em; }
            .custom-row { flex-direction: row; }
            input[type="number"], select { font-size: 0.9rem; padding: 8px; }
            table { min-width: auto; }
        }

        /* ëª¨ë°”ì¼ ê°€ë¡œëª¨ë“œ (Landscape) ìµœì í™” */
        @media (max-height: 600px) and (orientation: landscape) {
            body { padding-top: 40px !important; }
            .header-section { position: fixed !important; top: 0; left: 0; right: 0; height: 40px; padding: 0 15px; z-index: 999; display: flex; align-items: center; }
            .header-section h1 { font-size: 1rem; margin: 0 0 0 10px; line-height: 1; }
            .menu-btn { font-size: 1.2rem; padding: 0; }
            .container { padding-top: 10px !important; margin-top: 0 !important; }
            
            .visual-container { height: 120px; margin-bottom: 10px; }
            .bike { font-size: 40px; bottom: 20px; }
            .road { bottom: -460px; }
            
            .status-board { padding: 10px; margin-bottom: 10px; }
            .main-res { font-size: 1.8em; margin: 5px 0; }
            
            .setup-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            .group { grid-column: auto !important; padding: 8px; }
            
            input[type="number"], select, input[type="text"] { padding: 5px; }
            label { margin-bottom: 2px; font-size: 0.85em; }
        }

        .group-header td { background: #f1f3f5; font-weight: bold; color: #495057; text-align: left; padding: 8px 15px; font-size: 0.9em; border-top: 2px solid #dee2e6; }
        
        /* íŒŒì›Œì¡´ ì‹œê°í™” */
        .zone-legend { position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.9); padding: 5px 10px; border-radius: 8px; font-size: 0.7em; display: flex; flex-direction: column; gap: 2px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 10; }
        .zone-item { display: flex; align-items: center; gap: 5px; }
        .zone-color { width: 10px; height: 10px; border-radius: 50%; }
        .bike-zone-label { 
            position: absolute; bottom: -20px; left: 50%; transform: translateX(-50%) scaleX(-1); 
            font-size: 14px; font-weight: bold; background: rgba(255,255,255,0.8); 
            padding: 2px 6px; border-radius: 4px; white-space: nowrap; box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header-section">
        <button id="menuToggle" class="menu-btn" aria-label="ë©”ë‰´ ì—´ê¸°">â˜°</button>
        <h1>ğŸ”ï¸ ì—…í ë¶„ì„ê¸°</h1>
    </div>

    <div class="visual-container">
        <div id="road" class="road"></div>
        <div id="bike" class="bike">
            ğŸš´
            <div id="bikeZoneText" class="bike-zone-label">Z2</div>
        </div>
        <div class="zone-legend">
            <div class="zone-item"><div class="zone-color" style="background:#bdc3c7"></div>Z1 íšŒë³µ</div>
            <div class="zone-item"><div class="zone-color" style="background:#3498db"></div>Z2 ì§€êµ¬ë ¥</div>
            <div class="zone-item"><div class="zone-color" style="background:#2ecc71"></div>Z3 í…œí¬</div>
            <div class="zone-item"><div class="zone-color" style="background:#f1c40f"></div>Z4 ì—­ì¹˜</div>
            <div class="zone-item"><div class="zone-color" style="background:#e67e22"></div>Z5 VO2Max</div>
            <div class="zone-item"><div class="zone-color" style="background:#e74c3c"></div>Z6 ë¬´ì‚°ì†Œ</div>
            <div class="zone-item"><div class="zone-color" style="background:#9b59b6"></div>Z7 ì‹ ê²½ê·¼</div>
        </div>
    </div>



    <div class="status-board">
        <div id="course-tag" style="font-weight:bold; color:var(--primary); line-height:1.4;">
            ì½”ìŠ¤ ë¶„ì„ ì¤‘...
        </div>
        <div class="main-res"><span id="speed-display">0.0</span> km/h</div>
        <div id="current-gear-info" style="font-size: 0.9em; color: #666;">ê¸°ì¤€ ê¸°ì–´: 34-34T (1.00)</div>
    </div>

    <div class="setup-grid">
        <div class="group" style="grid-column: 1 / -1;">
            <label>ê²½ì‚¬ë„ ì„¤ì • <span id="val-slope">7</span>%</label>
            <input type="range" id="slope" min="0" max="25" step="0.5" value="7" oninput="run('slope')">
        </div>

        <div class="group highlight-box">
            <label>ì–¸ë•ì£¼í–‰ íŒŒì›Œ (Watt) <span id="val-power">200</span>W</label>
            <input type="range" id="power" min="50" max="800" step="5" value="200" oninput="run('power')">
        </div>

        <div class="group highlight-box">
            <label>ì–¸ì ì£¼í–‰ ì¼€ì´ë˜ìŠ¤ (RPM) <span id="val-cadence">80</span>rpm</label>
            <input type="range" id="cadence" min="30" max="120" step="1" value="80" oninput="run('cadence')">
        </div>

        <div class="group half-mobile"><label>ìì „ê±° ë¬´ê²Œ (kg)</label><input type="number" id="bikeW" value="8.5" oninput="run()"></div>
        <div class="group half-mobile"><label>ë‚´ ëª¸ë¬´ê²Œ (kg)</label><input type="number" id="riderW" value="75" oninput="run()"></div>
        <div class="group half-mobile"><label>ë‚˜ì˜ FTP (W)</label><input type="number" id="ftp" value="200" oninput="run()"></div>
        <div class="group half-mobile">
            <label>íœ  ê·œê²©</label>
            <select id="wheel" onchange="run()">
                <option value="2105">700c x 25mm</option>
                <option value="2136">700c x 28mm</option>
                <option value="2155">700c x 30mm</option>
                <option value="1938">650c x 23mm</option>
                <option value="2100">650b x 28mm</option>
            </select>
        </div>
        <div class="group half-mobile">
            <label>í˜„ì¬ ê¸°ì¤€ ê¸°ì–´ë¹„</label>
            <input type="text" id="baseGearDisplay" value="1.00 (34-34T)" disabled style="background:#eee; text-align:center; font-weight:bold;">
            <input type="hidden" id="baseGearVal" value="1.0">
        </div>
        <div class="group half-mobile">
            <label>âœ¨ ë‚´ ì–¸ë• ê¸°ì–´ ì§ì ‘ ì¶”ê°€</label>
            <div class="custom-row">
                <input type="number" id="cF" placeholder="ì•(T)">
                <input type="number" id="cR" placeholder="ë’¤(T)">
                <button class="add-btn" onclick="addGear()">ì¶”ê°€</button>
            </div>
        </div>
    </div>

    <h3>âš™ï¸ ê¸°ì–´ë¹„ ë¶„ì„ ë¦¬ìŠ¤íŠ¸ (í´ë¦­í•˜ì—¬ ê¸°ì¤€ìœ¼ë¡œ ì„¤ì •)</h3>
    <div class="hint">* í‘œì˜ í–‰ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê¸°ì–´ë¹„ë¡œ ìŠ¬ë¼ì´ë”ê°€ ë™ê¸°í™”ë©ë‹ˆë‹¤.</div>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th style="width:15%">êµ¬ë¶„</th>
                    <th style="width:40%">ì¡°í•© ë° ë¹„ê³ </th>
                    <th style="width:15%">ê¸°ì–´ë¹„</th>
                    <th style="width:30%">í•„ìš” ì¼€ì´ë˜ìŠ¤</th>
                </tr>
            </thead>
            <tbody id="res-body"></tbody>
        </table>
    </div>
</div>

<script>

let GEAR_PRESETS = [
    // 1. ì»´íŒ©íŠ¸/ë¯¸ë“œì»´íŒ© ì—…íìš©
    { section: "1. ì»´íŒ©íŠ¸/ë¯¸ë“œì»´íŒ© ì—…íìš© (ë‚®ì€ ê¸°ì–´ë¹„)", cat: "ì—…í", name: "ì»´íŒ©íŠ¸ ìƒì¡´", f: 34, r: 34, desc: "ê°€ì¥ ê°€ë²¼ìš´ ê¸°ì–´ë¹„" },
    { section: "1. ì»´íŒ©íŠ¸/ë¯¸ë“œì»´íŒ© ì—…íìš© (ë‚®ì€ ê¸°ì–´ë¹„)", cat: "ì—…í", name: "ë¯¸ë“œì»´íŒ© í‘œì¤€", f: 36, r: 30, desc: "ì—…í í‘œì¤€ ì„¸íŒ…" },
    { section: "1. ì»´íŒ©íŠ¸/ë¯¸ë“œì»´íŒ© ì—…íìš© (ë‚®ì€ ê¸°ì–´ë¹„)", cat: "ì—…í", name: "ìŠ¤íƒ ë‹¤ë“œ ìƒê¸‰", f: 39, r: 28, desc: "ìƒê¸‰ììš© ê¸°ì–´ë¹„" },

    // 2. ë‚®ì€ ì–¸ë•/ë‚™íƒ€ë“± ëŒíŒŒìš©
    { section: "2. ë‚®ì€ ì–¸ë•/ë‚™íƒ€ë“± ëŒíŒŒìš© (ì¤‘ê°„ ê¸°ì–´ë¹„)", cat: "ë‚™íƒ€ë“±", name: "ì´ë„ˆ ê³ ì†", f: 36, r: 15, desc: "ì´ë„ˆ ì²´ì¸ë§ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë„˜ì„ ë•Œ" },
    { section: "2. ë‚®ì€ ì–¸ë•/ë‚™íƒ€ë“± ëŒíŒŒìš© (ì¤‘ê°„ ê¸°ì–´ë¹„)", cat: "ë‚™íƒ€ë“±", name: "ì•„ìš°í„° ì¤‘ì €ì†", f: 50, r: 28, desc: "ì•„ìš°í„°ë¡œ ë²„í‹°ë©° ì˜¤ë¥¼ ë•Œ" },
    { section: "2. ë‚®ì€ ì–¸ë•/ë‚™íƒ€ë“± ëŒíŒŒìš© (ì¤‘ê°„ ê¸°ì–´ë¹„)", cat: "ë‚™íƒ€ë“±", name: "ì•„ìš°í„° í‘œì¤€", f: 52, r: 25, desc: "ë¯¸ë“œì»´íŒ© ì•„ìš°í„° í‘œì¤€" },

    // 3. í‰ì§€/ê³ ì† êµ¬ê°„
    { section: "3. í‰ì§€/ê³ ì† êµ¬ê°„ (ë†’ì€ ê¸°ì–´ë¹„)", cat: "í‰ì§€", name: "ì•„ìš°í„° ê³ ì†", f: 50, r: 11, desc: "ì»´íŒ©íŠ¸ ìµœê³  ì†ë„" },
    { section: "3. í‰ì§€/ê³ ì† êµ¬ê°„ (ë†’ì€ ê¸°ì–´ë¹„)", cat: "í‰ì§€", name: "ìŠ¤íƒ ë‹¤ë“œ ì•„ìš°í„°", f: 53, r: 11, desc: "ìŠ¤íƒ ë‹¤ë“œ ìµœê³  ì†ë„" },
    { section: "3. í‰ì§€/ê³ ì† êµ¬ê°„ (ë†’ì€ ê¸°ì–´ë¹„)", cat: "í‰ì§€", name: "ì´ˆê³ ì† ì»¤ìŠ¤í…€", f: 60, r: 28, desc: "ë¯¸ë‹ˆë²¨ë¡œ ë“± íŠ¹ìˆ˜ ëª©ì " },
    { section: "3. í‰ì§€/ê³ ì† êµ¬ê°„ (ë†’ì€ ê¸°ì–´ë¹„)", cat: "ì „ë¬¸ê°€", name: "í”„ë¡œ ë…ì£¼ìš©", f: 56, r: 11, desc: "TT/ì² ì¸ ê²½ê¸°ìš©" }
];

function addGear() {
    const f = parseInt(document.getElementById('cF').value);
    const r = parseInt(document.getElementById('cR').value);
    if(f && r) {
        GEAR_PRESETS.push({ section: "âœ¨ ì§ì ‘ ì…ë ¥í•œ ê¸°ì–´", cat: "ì»¤ìŠ¤í…€", name: "ì‚¬ìš©ì ì„¤ì •", f: f, r: r, desc: "ì§ì ‘ ì¶”ê°€í•¨" });
        document.getElementById('cF').value = ""; document.getElementById('cR').value = "";
        run();
    }
}

// í´ë¦­ ì‹œ ê¸°ì¤€ ê¸°ì–´ë¹„ë¥¼ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
function setAsBase(ratio, label) {
    document.getElementById('baseGearVal').value = ratio;
    document.getElementById('baseGearDisplay').value = `${ratio.toFixed(2)} (${label})`;
    document.getElementById('current-gear-info').innerText = `ê¸°ì¤€ ê¸°ì–´: ${label} (${ratio.toFixed(2)})`;
    run('cadence'); // ì¼€ì´ë˜ìŠ¤ ê³ ì • ìƒíƒœì—ì„œ íŒŒì›Œ ì—­ì‚°
}

function run(mode) {
    const slope = parseFloat(document.getElementById('slope').value);
    const bikeW = parseFloat(document.getElementById('bikeW').value);
    const riderW = parseFloat(document.getElementById('riderW').value);
    const ftp = parseFloat(document.getElementById('ftp').value) || 200;
    const wheel = parseInt(document.getElementById('wheel').value);
    const baseRatio = parseFloat(document.getElementById('baseGearVal').value);
    const totalW = bikeW + riderW;
    const g = 9.81;
    const Crr = 0.005;
    const rad = Math.atan(slope/100);

    let power = parseFloat(document.getElementById('power').value);
    let cadence = parseFloat(document.getElementById('cadence').value);

    if (mode === 'cadence') {
        const v_kmh = (baseRatio * wheel * cadence * 60) / 1000000;
        const v_ms = v_kmh / 3.6;
        power = totalW * g * v_ms * (Math.sin(rad) + Crr);
        document.getElementById('power').value = Math.min(800, Math.round(power));
    } else {
        let v_ms = power / (totalW * g * (Math.sin(rad) + Crr));
        let kmh = Math.max(0, v_ms * 3.6);
        cadence = (kmh * 1000000) / (baseRatio * wheel * 60);
        document.getElementById('cadence').value = Math.min(120, Math.round(cadence));
    }

    // UI ì—…ë°ì´íŠ¸
    document.getElementById('val-slope').innerText = slope;
    document.getElementById('val-power').innerText = document.getElementById('power').value;
    document.getElementById('val-cadence').innerText = document.getElementById('cadence').value;
    
    const deg = rad * (180/Math.PI);
    document.getElementById('road').style.transform = `rotate(-${deg}deg)`;
    document.getElementById('bike').style.transform = `rotate(-${deg}deg) scaleX(-1)`;

    // íŒŒì›Œì¡´ ê³„ì‚° ë° ìƒ‰ìƒ ì ìš©
    const currentPower = parseFloat(document.getElementById('power').value);
    const pRatio = (currentPower / ftp) * 100;
    let zColor = "#555";
    let zText = "Z1";
    
    if (pRatio < 55) { zColor = "#bdc3c7"; zText = "Z1 íšŒë³µ"; }
    else if (pRatio < 76) { zColor = "#3498db"; zText = "Z2 ì§€êµ¬ë ¥"; }
    else if (pRatio < 91) { zColor = "#2ecc71"; zText = "Z3 í…œí¬"; }
    else if (pRatio < 106) { zColor = "#f1c40f"; zText = "Z4 ì—­ì¹˜"; }
    else if (pRatio < 121) { zColor = "#e67e22"; zText = "Z5 VO2Max"; }
    else if (pRatio < 151) { zColor = "#e74c3c"; zText = "Z6 ë¬´ì‚°ì†Œ"; }
    else { zColor = "#9b59b6"; zText = "Z7 ì‹ ê²½ê·¼"; }

    document.getElementById('road').style.background = zColor;
    document.getElementById('bikeZoneText').innerText = zText;

    let final_v_ms = currentPower / (totalW * g * (Math.sin(rad) + Crr));
    let final_kmh = Math.max(0, final_v_ms * 3.6);
    document.getElementById('speed-display').innerText = final_kmh.toFixed(1);

    // ì½”ìŠ¤ íƒœê·¸
    const courseTag = document.getElementById('course-tag');
    let cName = "í‰ì§€ ë° ì™„ë§Œí•œ êµ¬ê°„";
    let cDesc = "";

    if (slope >= 20) {
        cName = "ë²½ (The Wall)";
        cDesc = "ìì „ê±° ì•ë°”í€´ê°€ ë“¤ë¦´ ìˆ˜ ìˆëŠ” ê·¹ì•…ì˜ ê²½ì‚¬";
    } else if (slope >= 15) {
        cName = "ì‚¼ë§‰ì‚¬ 'í• ë”±ê³ ê°œ' ê¸‰";
        cDesc = "ëŒ„ì‹± ì—†ì´ëŠ” ëŒë¦¬ê¸° í˜ë“  ë¬´ì‹œë¬´ì‹œí•œ êµ¬ê°„";
    } else if (slope >= 12) {
        cName = "í™”ì•…ì‚° / ë¬´ë“±ì‚° 8ë¶€ ëŠ¥ì„ ";
        cDesc = "êµ­ë‚´ ìµœê³  ë‚œì´ë„ ì—…íì˜ ë³¸ëª¨ìŠµ";
    } else if (slope >= 10) {
        cName = "ë¯¸ì‹œë ¹ ì˜›ê¸¸ / ì§€ì•ˆì¬ ê¸‰";
        cDesc = "ë³¸ê²©ì ì¸ 'ì¹¨ í˜ë¦¬ëŠ”' ì—…í êµ¬ê°„";
    } else if (slope >= 8) {
        cName = "ë¶ì•… ìŠ¤ì¹´ì´ì›¨ì´ / ëŒ€ê´€ë ¹";
        cDesc = "ì¤‘ê¸‰ ë¼ì´ë”ì˜ ì‹¤ë ¥ì„ ê°€ë¥´ëŠ” ê¸°ì¤€ì ";
    } else if (slope >= 6) {
        cName = "ì„œìš¸ ë‚¨ì‚° (ì¤‘ë°˜ë¶€) ê¸‰";
        cDesc = "ë™í˜¸ì¸ë“¤ì˜ êµ­ë¯¼ ì—…í ì½”ìŠ¤ ë‚œì´ë„";
    } else if (slope >= 4) {
        cName = "ë¶„ì›ë¦¬ / í•˜ì˜¤ê³ ê°œ ê¸‰";
        cDesc = "ë¦¬ë“œë¯¸ì»¬í•œ ì—…íì´ ê°€ëŠ¥í•œ í‘œì¤€ ê²½ì‚¬";
    } else if (slope >= 2) {
        cName = "ì™„ë§Œí•œ ë‚™íƒ€ë“± êµ¬ê°„";
        cDesc = "ì—ì–´ë¡œ ìì„¸ë¥¼ í’€ê²Œ ë˜ëŠ” ì•½ì˜¤ë¥´ë§‰";
    } else if (slope > 0) {
        cName = "í‰ì§€ ê°™ì€ ì˜¤ë¥´ë§‰";
        cDesc = "ë¯¸ì„¸í•˜ê²Œ íŒŒì›Œê°€ ë” ì‹¤ë¦¬ëŠ” êµ¬ê°„";
    }

    courseTag.innerHTML = `<span style="font-size:1.2em;">${cName}</span><br><span style="font-size:0.8em; font-weight:normal; color:#e67e22;">${cDesc}</span>`;


    // í…Œì´ë¸” ë Œë”ë§ (ê¸°ì¡´ run í•¨ìˆ˜ í•˜ë‹¨ë¶€ tbody.innerHTML ë¶€ë¶„ì„ ì•„ë˜ë¡œ êµì²´)
    const tbody = document.getElementById('res-body');
    tbody.innerHTML = "";
    
    let currentSection = "";
    GEAR_PRESETS.forEach(g => {
        const ratio = g.f / g.r;
        const speed = parseFloat(document.getElementById('speed-display').innerText);
        const wheel = parseInt(document.getElementById('wheel').value);
        const baseRatio = parseFloat(document.getElementById('baseGearVal').value);
        
        // í˜„ì¬ ì†ë„ì—ì„œì˜ ì¼€ì´ë˜ìŠ¤ ê³„ì‚°
        const rpm = (speed * 1000000) / (ratio * wheel * 60);
        
        // ìƒíƒœë³„ í´ë˜ìŠ¤ ë¶€ì—¬ (70ë¯¸ë§Œ ë¬´ë¦ì£¼ì˜, 70~95 ìµœì )
        let rpmClass = "";
        let rpmLabel = "";
        let rpmStyle = "font-size:1.1em;";

        if (rpm < 70) {
            rpmClass = "rpm-bad";
            rpmLabel = "<div style='font-size:0.6em; margin-top:2px;'>ë¬´ë¦ì£¼ì˜</div>";
        } else if (rpm >= 70 && rpm <= 95) {
            rpmClass = "rpm-good";
            rpmLabel = "<div style='font-size:0.6em; margin-top:2px;'>ìµœì </div>";
        } else {
            rpmClass = "rpm-neutral";
        }

        // ê¸°ì¤€ ê¸°ì–´ë¹„ì™€ ì¼ì¹˜í•˜ëŠ” í–‰ í•˜ì´ë¼ì´íŠ¸
        const isActive = ratio.toFixed(2) === baseRatio.toFixed(2) ? "active-row" : "";

        // ì„¹ì…˜ í—¤ë” ì¶”ê°€
        if (g.section !== currentSection) {
            currentSection = g.section;
            tbody.innerHTML += `<tr class="group-header"><td colspan="4">${currentSection}</td></tr>`;
        }

        tbody.innerHTML += `
            <tr class="clickable ${isActive}" onclick="setAsBase(${ratio}, '${g.f}-${g.r}T')">
                <td style="font-weight:bold; color:#666;">${g.cat}</td>
                <td>
                    <div style="font-weight:bold;">${g.f}-${g.r}T</div>
                    <div style="font-size:0.8em; color:var(--primary);">${g.name}</div>
                    <div style="font-size:0.75em; color:#888; margin-top:2px;">${g.desc}</div>
                </td>
                <td style="color:#888;">${ratio.toFixed(2)}</td>
                <td class="${rpmClass}" style="${rpmStyle}">
                    ${Math.round(rpm)} <span style="font-size:0.7em;">RPM</span>
                    ${rpmLabel}
                </td>
            </tr>`;
    });
}
run();


</script>
</body>
</html>